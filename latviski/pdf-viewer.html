<!DOCTYPE html>
<html lang="lv">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>PDF skatītājs – Niemi Isolering</title>
  <link rel="stylesheet" href="../style.css" />
  <style>
    .viewer-top {
      position: sticky; top: 0; z-index: 10;
      background: rgba(255,255,255,.9);
      border-bottom: 1px solid rgba(0,0,0,.06);
      backdrop-filter: blur(6px);
    }
    .viewer-bar {
      max-width: var(--max); margin: 0 auto; padding: 10px 16px;
      display:flex; gap:10px; align-items:center; justify-content:space-between;
    }
    .viewer-actions { display:flex; gap:8px; flex-wrap: wrap; }
    .pdf-frame {
      width: 100%; height: 88vh; border: 0; background: #f5f7f8;
      box-shadow: inset 0 0 0 1px rgba(0,0,0,.04);
    }
  </style>
</head>
<body>
  <header class="viewer-top">
    <div class="viewer-bar">
      <div class="brand">NIEMI ISOLERING</div>
      <div class="viewer-actions">
        <button class="btn-outline" onclick="history.back()">← Atpakaļ</button>
        <a id="dl" class="btn" href="#" target="_blank" rel="noopener">Lejupielādēt PDF</a>
        <a class="btn-outline" href="../index.html">Sākums</a>
      </div>
    </div>
  </header>

  <main class="container" style="max-width:none; padding-top:10px;">
    <iframe id="frame" class="pdf-frame" title="PDF skatītājs"></iframe>
    <p class="muted" id="fallback" style="margin-top:.5rem; display:none">
      Ja PDF neatveras, noklikšķiniet šeit:
      <a id="raw" href="#" target="_blank" rel="noopener">atvērt tiešo saiti</a>.
    </p>
  </main>

  <script>
  // Hae ?file=... parametrin arvo
  const params = new URLSearchParams(location.search);
  let file = params.get('file') || '';
  // Perusvarmistus: ei saa hypätä domainin ulkopuolelle
  if (file.startsWith('http')) file = '';
  if (!file) file = 'lvpdf/1.lv.pdf'; // varalla

  const frame = document.getElementById('frame');
  const dl = document.getElementById('dl');
  const raw = document.getElementById('raw');
  const fallback = document.getElementById('fallback');

  // Pages-osoite
  const pagesURL = '../' + file.replace(/^\/*/, '');
  // Raw-varalinkki
  const rawURL = 'https://raw.githubusercontent.com/Markku2809/latviab/main/' + file.replace(/^\/*/, '');

  frame.src = pagesURL;
  dl.href = pagesURL;
  raw.href = rawURL;

  // Jos Pages-linkki ei vastaa (esim. 404), näytetään varalinkki
  fetch(pagesURL, {method:'HEAD'}).then(r => {
    if (!r.ok) {
      frame.src = rawURL;
      dl.href = rawURL;
      fallback.style.display = 'block';
    }
  }).catch(() => {
    frame.src = rawURL;
    dl.href = rawURL;
    fallback.style.display = 'block';
  });
  </script>
</body>
</html>
